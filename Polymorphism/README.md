# Полиморфизм (виртуальные функции) / Polymorphism
Тут все несколько сложнее. Допустим, что класс antenna включает множество подклассов, помимо класса radar. Назовем один из других классов locator. Оба класса наследуют параметры суперкласса antenna, но и имеют свои отличительные особенности (другой диапазон рабочих частот, разное количество излучателей и т.д.). Получение данных о количестве излучателей, например, зависит от физических параметров объекта. То есть, на уровне класса antenna метод получения количества излучателей одинаков для всех подклассов, но реализация для каждого конечного подкласса отличается от другой реализации другого подкласса. Другими словами, вызывая одну и ту же функцию из суперкласса, должен происходить вызов уникальной для каждого подкласса функции. Для этого в класс antenna вводится постоянный указатель на структуру, содержащую указатели на эти уникальные функции:

`struct antenna_vtbl const *vptr;`

`struct antenna_vtbl {`

	uint32_t (*number_of_emitters)(antenna const * const me); //получить количество излучателей
  
	void (*change_range)(antenna const * const me); //изменить диапазон работы
  
`};`

Реализация виртуальных функций:

Получить количество излучателей

`static inline uint32_t antenna_get_number_of_emitters (antenna const * const me)`

`{`

	return (*me->vptr->number_of_emitters)(me);  
    
`}`

Изменить диапазон работы
 
`static inline void antenna_change_range (antenna const * const me)` 

`{`

	(*me->vptr->change_range)(me);
    
`}`

Прототипы функций, вызывающие общие функции:

`antenna const *get_antenna_with_max_emitters (antenna const *antennas[], uint32_t n_antennas);`

`void change_range_all_antennas (antenna const *antennas[], uint32_t n_antennas);`

Применение виртуальных функций приводит к использованию позднего связывания или динамической привязки. Это когда экземпляр вызываемой функции определяется не в процессе компиляции и линковки, а при выполнении программы.

Практически все компиляторы C++ реализуют позднее связывание с помощью одной виртуальной таблицы (vtbl) для каждого класса и виртуального указателя (vptr) для каждого объекта. Этот метод можно применить и к C. Виртуальная таблица — это таблица указателей функций, соответствующих виртуальным функциям, представленным классом. В C виртуальная таблица может быть эмулирована структурой указателей на функции. Виртуальный указатель (vptr) — это указатель на виртуальную таблицу класса. Этот указатель должен присутствовать в каждом экземпляре (объекте) класса, поэтому он должен входить в структуру атрибутов класса.
